# ZZST主数据库设计说明

主要包括五个数据表：**事件库**，**人物库**，**信息库**，**热帖库**，**事件任务库**。

## 事件库（表名：Event）
**事件库**用于存放系统核心**政治敏感**事件，由业务人员点击入库或系统算法自动入库。主键为事件对应的**事件序号**。具体字段及说明如下表所示：

| 字段名  | 中文名  | 数据类型  | 长度 | 字段说明  | 备注  |
| ------------ | ------------ | ------------ | ------------ | ------------ |------------ |
| e_id  | 事件序号  | VARCHAR  | 30 | 事件的序号  | 主键  |
| event_name  | 事件名  | VARCHAR  | 50 | 事件简要名称  | 无  |
| keywords_dict  | 关键词  | VARCHAR  | 100 | 事件中提取的关键词  | 逗号分隔的字符串或json串  |
| begin_timestamp  | 开始时间戳  | BIGINT  | 20 | 事件开始时间的时间戳  | 可由业务人员设定  |
| begin_date  | 开始日期  | DATE  | 无 | 事件的开始日期  | 可由业务人员设定  |
| end_timestamp  | 结束时间戳  | BIGINT  | 20 | 事件结束时间的时间戳  | 可由业务人员设定，可以为空  |
| end_date  | 结束时间  | DATE  | 无 | 事件的结束日期  | 可由业务人员设定，可以为空  |
| content  | 内容  | VARCHAR  | 400 | 事件的具体内容  | 该条微博的内容  |
| uid  | 用户序号  | VARCHAR  | 30 | 发布微博的用户ID  | 可以为空  |
> 字段可以根据需求进行修改。

## 信息库（表名：Information）
**信息库**用于存放事件相关的帖子，以保证事件的计算，主键为每条信息对应的**序号（来源+mid）**。具体字段及说明如下表所示：

| 字段名  | 中文名  | 数据类型  | 长度 | 字段说明  | 备注  |
| ------------ | ------------ | ------------ | ------------ | ------------ |------------ |
| i_id  | 信息序号  | VARCHAR  | 30 | 信息的序号（来源+mid）  | 主键  |
| uid  | 用户序号  | VARCHAR  | 30 | 发布微博的用户ID  | 无  |
| root_uid  | 原始用户序号  | VARCHAR  | 30 | 发布原始微博的用户ID  | 无  |
| mid  | 微博id  | VARCHAR  | 30 | 该信息的微博id  | 无  |
| comment  | 评论数  | INT  | 11 | 该条微博的评论数  | 无  |
| retweeted  | 转发数  | INT  | 11 | 该条微博的转发数  | 无  |
| text  | 内容  | VARCHAR  | 400 | 信息帖子的具体内容  | 该条微博的内容  |
| keywords_dict  | 关键词  | VARCHAR  | 100 | 微博中提取的关键词  | 逗号分隔的字符串或json串  |
| timestamp  | 时间戳  | BIGINT  | 20 | 微博发布时间的时间戳  | 无  |
| date  | 日期  | DATE  | 无 | 微博的发布日期  | 无  |
| ip  | IP地址  | VARCHAR  | 20 | 发布微博的IP地址  | 无  |
| geo  | 地理位置  | VARCHAR  | 50 | 发布微博的地理位置  | 无  |
| message_type  | 信息类型  | INT  | 11 | 信息类型  | 无  |
| root_mid  | 原始微博id  | VARCHAR  | 30 | 原始微博id  | 无  |
| source  | 信息来源  | VARCHAR  | 20 | 信息的来源  | 无  |
| i_level  | 信息等级  | INT  | 11 | 信息的等级  | 级别分为1,2,3  |

> 字段可以根据需求进行修改。ip和地理位置信息比较**敏感**，谨慎使用。后续还可能会有计算指标的添加，比如“情感极性”。

## 人物库（表名：Figure）
**人物库**用于存放事件相关的人物信息，主键为每个人物对应的**微博账户ID**。具体字段及说明如下表所示：

| 字段名  | 中文名  | 数据类型  | 长度 | 字段说明  | 备注  |
| ------------ | ------------ | ------------ | ------------ | ------------ |------------ |
| f_id  | 人物序号  | VARCHAR  | 30 | 该人物的微博账户ID  | 主键  |
| gender  | 性别  | TINYINT  | 1 | 人物性别  | 布尔类型，True：男，Fales：女,Null：未填写  |
| follow_num  | 关注数  | INT  | 11 | 该人物的关注数量  | 可以为空  |
| fans_num  | 粉丝数  | INT  | 11 | 该人物的粉丝数量  | 可以为空  |
| tweets_num  | 微博数  | INT  | 11 | 该人物所发布的微博数量  | 可以为空  |
| authentication  | 微博认证  | VARCHAR  | 50 | 该人物的微博认证信息  | 可以为空  |
| address  | 居住地址  | VARCHAR  | 50 | 该人物的居住地  | 可以为空  |

> 字段可以根据需求进行修改。居住地址为用户自己填写，可能不太准确。如果没有微博认证信息，**可以为空**。

## 热帖推出库（表名：Hot_post）
**热帖推出库**保存系统一天内推出的热帖，以保证信息正常入库，主键为**热帖序号（来源+mid）**。具体字段说明如下表所示：

| 字段名  | 中文名  | 数据类型  | 长度 | 字段说明  | 备注  |
| ------------ | ------------ | ------------ | ------------ | ------------ |------------ |
| h_id  | 热帖序号  | VARCHAR  | 30 | 热帖的序号（来源+mid）  | 主键  |
| uid  | 用户序号  | VARCHAR  | 30 | 发布微博的用户ID  | 无  |
| root_uid  | 原始用户序号  | VARCHAR  | 30 | 发布原始微博的用户ID  | 无  |
| mid  | 微博id  | VARCHAR  | 30 | 该热帖的微博id  | 无  |
| comment  | 评论数  | INT  | 11 | 该条微博的评论数  | 无  |
| retweeted  | 转发数  | INT  | 11 | 该条微博的转发数  | 无  |
| text  | 内容  | VARCHAR  | 400 | 信息帖子的具体内容  | 该条微博的内容  |
| keywords_dict  | 关键词  | VARCHAR  | 100 | 微博中提取的关键词  | 逗号分隔的字符串或json串  |
| timestamp  | 时间戳  | BIGINT  | 20 | 微博发布时间的时间戳  | 无  |
| date  | 日期  | DATE  | 无 | 微博的发布日期  | 无  |
| ip  | IP地址  | VARCHAR  | 20 | 发布微博的IP地址  | 无  |
| geo  | 地理位置  | VARCHAR  | 50 | 发布微博的地理位置  | 无  |
| message_type  | 信息类型  | INT  | 11 | 信息类型  | 无  |
| root_mid  | 原始微博id  | VARCHAR  | 30 | 原始微博id  | 无  |
| source  | 信息来源  | VARCHAR  | 20 | 信息的来源  | 无  |
| store_timestamp  | 存储时间戳  | BIGINT  | 20 | 该帖子的入库时间戳  | 用于计算热帖更新时间  |
| store_date  | 存储日期  | DATE  | 无 | 该帖子的入库日期  | 用于计算热帖更新时间  |

>字段可以根据需求进行修改。

## 信息事件关联表（表名：Event_Information）
**信息事件关联表**用于存放信息库内的**帖子**与事件库内的**事件**之间的**关联关系**，主键为mysql**自增主键ID**。具体字段及说明如下表所示：

| 字段名  | 中文名  | 数据类型  | 长度 | 字段说明  | 备注  |
| ------------ | ------------ | ------------ | ------------ | ------------ |------------ |
| id  | 序号  | INT  | 11 | 自动创建的自增主键  | 主键  |
| information_id  | 信息表序号  | VARCHAR  | 30 | 信息库表的主键i_id  | 外键  |
| event_id  | 事件表序号  | VARCHAR  | 30 | 事件库表的主键e_id  | 外键 |

> 一个事件可以拥有多个相关的帖子信息，一个帖子信息也可以属于多个事件。一个事件至少有一个帖子，一个帖子可以不属于任何一个事件。

## 人物事件关联表（表名：Event_Figure）
**人物事件关联表**用于存放人物库内的**人物**与事件库内的**事件**之间的**关联关系**，主键为mysql**自增主键ID**。具体字段及说明如下表所示：

| 字段名  | 中文名  | 数据类型  | 长度 | 字段说明  | 备注  |
| ------------ | ------------ | ------------ | ------------ | ------------ |------------ |
| id  | 序号  | INT  | 11 | 自动创建的自增主键  | 主键  |
| figure_id  | 人物表序号  | VARCHAR  | 30 | 人物库表的主键f_id  | 外键  |
| event_id  | 事件表序号  | VARCHAR  | 30 | 事件库表的主键e_id  | 外键  |

> 一个事件可以拥有多个相关的人物，一个人物也可以属于多个事件。

## 事件任务表（表名：Task）
**事件任务表**存放从**热帖推出库**选定的待计算事件，包含不同任务类型及状态，保证计算任务的执行。具体字段及说明如下表所示：

| 字段名  | 中文名  | 数据类型  | 长度 | 字段说明  | 备注  |
| ------------ | ------------ | ------------ | ------------ | ------------ |------------ |
| t_id  | 任务序号  | VARCHAR  | 30 | 任务的id  | 主键  |
| task_type  | 任务类型  | INT  | 11 | 当前的任务类型  | 包括新事件入库任务和相关帖子入库任务  |
| into_type  | 入库类型  | INT  | 11 | 任务的入库类型  | 包括人工添加和系统推送  |
| status  | 任务状态  | INT  | 11 | 当前任务的状态  | 包括未计算，已计算，计算中和计算失败  |
| e_id  | 事件序号  | VARCHAR  | 100 | 任务相关联的事件id  | 可以为空，可输入多个id，用逗号隔开  |
| uid  | 用户序号  | VARCHAR  | 30 | 发布微博的用户ID  | 可以为空  |
| root_uid  | 原始用户序号  | VARCHAR  | 30 | 发布原始微博的用户ID  | 可以为空  |
| mid  | 微博id  | VARCHAR  | 30 | 微博的ID  | 可以为空  |
| comment  | 评论数  | INT  | 11 | 该条微博的评论数  | 可以为空  |
| retweeted  | 转发数  | INT  | 11 | 该条微博的转发数  | 可以为空  |
| text  | 内容  | VARCHAR  | 400 | 信息帖子的具体内容  | 该条微博的内容  |
| keywords_dict  | 关键词  | VARCHAR  | 100 | 微博中提取的关键词  | 逗号分隔的字符串或json串  |
| timestamp  | 时间戳  | BIGINT  | 20 | 微博发布时间的时间戳  | 可以为空  |
| date  | 日期  | DATE  | 无 | 微博的发布日期  | 可以为空  |
| ip  | IP地址  | VARCHAR  | 20 | 发布微博的IP地址  | 可以为空  |
| geo  | 地理位置  | VARCHAR  | 50 | 发布微博的地理位置  | 可以为空  |
| message_type  | 信息类型  | INT  | 11 | 信息类型  | 可以为空  |
| root_mid  | 原始微博id  | VARCHAR  | 30 | 原始微博id  | 可以为空  |
| source  | 信息来源  | VARCHAR  | 20 | 信息的来源  | 无  |
| into_timestamp  | 任务入库时间戳  | BIGINT  | 20 | 该帖子的入库时间戳  | 用于计算任务更新时间  |
| into_date  | 任务入库日期  | DATE  | 无 | 该帖子的入库日期  | 用于计算任务更新时间  |

>字段可以根据需求进行修改。